---
import { SITE_TITLE, SOCIAL } from '../consts';
import HeaderLink from './HeaderLink.astro';

const socials = [
	{ key: 'github', label: 'GitHub', href: SOCIAL.github },
	{ key: 'x', label: 'X', href: SOCIAL.x },
	{ key: 'mastodon', label: 'Mastodon', href: SOCIAL.mastodon },
	{ key: 'email', label: 'Email', href: SOCIAL.email ? `mailto:${SOCIAL.email}` : '' },
].filter((s) => !!s.href);
---

<header class="topbar">
	<nav class="topbar__nav">
		<a class="topbar__brand" href="/">
			<span class="topbar__mark" aria-hidden="true"></span>
			<span class="topbar__name">{SITE_TITLE}</span>
		</a>

		<div class="topbar__links" aria-label="Primary">
			<HeaderLink href="/">首页</HeaderLink>
			<HeaderLink href="/blog">文章</HeaderLink>
			<HeaderLink href="/tags">标签</HeaderLink>
			<HeaderLink href="/search">搜索</HeaderLink>
			<HeaderLink href="/about">关于</HeaderLink>
		</div>

		{socials.length > 0 && (
			<div class="topbar__social" aria-label="Social">
				{socials.map((s) => (
					<a class="topbar__socialLink" href={s.href} target={s.key === 'email' ? undefined : '_blank'} rel="me">
						{s.label}
					</a>
				))}
			</div>
		)}
	</nav>
</header>

<style>
	.topbar {
		position: sticky;
		top: 0;
		z-index: 50;
		border-bottom: 1px solid rgba(16, 18, 22, 0.12);
		background: rgba(249, 247, 242, 0.72);
		backdrop-filter: blur(10px);
	}
	.topbar__nav {
		max-width: var(--maxw);
		margin: 0 auto;
		padding: 0.95rem 1.1rem;
		display: flex;
		align-items: center;
		justify-content: space-between;
		gap: 1rem;
		flex-wrap: wrap;
	}
	.topbar__brand {
		background-image: none;
		display: inline-flex;
		align-items: center;
		gap: 0.65rem;
		font-weight: 900;
		letter-spacing: -0.02em;
	}
	.topbar__mark {
		width: 12px;
		height: 12px;
		border-radius: 999px;
		background: var(--accent);
		box-shadow: 0 0 0 7px rgba(31, 75, 255, 0.12);
	}
	.topbar__name {
		transform: translateY(-0.5px);
	}

	.topbar__links {
		display: flex;
		gap: 0.25rem;
		flex-wrap: wrap;
	}
	.topbar__links :global(a) {
		background-image: none;
		color: rgba(var(--ink), 0.88);
		padding: 0.45rem 0.6rem;
		border-radius: 999px;
		border: 1px solid transparent;
		transition: border 140ms ease, background 140ms ease, transform 140ms ease;
	}
	.topbar__links :global(a:hover) {
		background: rgba(31, 75, 255, 0.06);
		border-color: rgba(31, 75, 255, 0.16);
		transform: translateY(-1px);
	}
	.topbar__links :global(a.active) {
		background: rgba(31, 75, 255, 0.11);
		border-color: rgba(31, 75, 255, 0.22);
		color: rgba(var(--ink), 0.98);
	}

	.topbar__social {
		display: flex;
		gap: 0.55rem;
		flex-wrap: wrap;
		opacity: 0.9;
		font-size: 0.92rem;
	}
	.topbar__socialLink {
		background-image: none;
		color: rgba(var(--muted), 1);
		padding: 0.25rem 0.35rem;
		border-radius: 10px;
	}
	.topbar__socialLink:hover { color: rgba(var(--ink), 0.96); }

	@media (max-width: 720px) {
		.topbar__social { display: none; }
	}
</style>
